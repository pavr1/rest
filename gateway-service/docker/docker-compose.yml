# Gateway Service Docker Compose
# NOTE: Depends on session-service and data-service
# Use root Makefile: make fresh (handles startup order)

services:
  gateway-service:
    build:
      context: ../..
      dockerfile: gateway-service/docker/Dockerfile
    container_name: barrest_gateway_service
    restart: unless-stopped
    environment:
      - SERVER_HOST=0.0.0.0
      - SERVER_PORT=8082
      - DATA_SERVICE_URL=http://barrest_data_service:8086
    ports:
      - "8082:8082"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8082/api/v1/gateway/p/health"]
      interval: 1s
      timeout: 5s
      retries: 3
      start_period: 10s
    networks:
      - docker_barrest_network

networks:
  docker_barrest_network:
    external: true
