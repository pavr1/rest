# Bar Restaurant - UI Service Makefile

.PHONY: start stop restart logs status clean test help

.DEFAULT_GOAL := help

# =============================================================================
# üöÄ DOCKER COMMANDS
# =============================================================================

start: ## Start UI service container
	@echo "üé® Starting UI Service..."
	@cd docker && docker-compose up -d --build
	@echo "‚úÖ UI Service started on http://localhost:3000"

stop: ## Stop UI service container
	@echo "üõë Stopping UI Service..."
	@cd docker && docker-compose down
	@echo "‚úÖ UI Service stopped!"

restart: stop start ## Restart UI service

logs: ## View UI service logs
	@cd docker && docker-compose logs -f

status: ## Show UI service status
	@echo "üìä UI Service Status:"
	@cd docker && docker-compose ps

clean: ## Remove container and images
	@cd docker && docker-compose down -v --rmi local 2>/dev/null || true
	@echo "‚úÖ UI Service cleaned!"

# =============================================================================
# üß™ TESTING & VALIDATION
# =============================================================================

test: ## Run UI health check
	@echo "üß™ Testing UI Service..."
	@curl -sf http://localhost:3000/health > /dev/null && echo "‚úÖ UI Service is healthy!" || echo "‚ùå UI Service is not responding"

# =============================================================================
# üíª LOCAL DEVELOPMENT (optional, requires npm)
# =============================================================================

install: ## Install npm dependencies (for local dev)
	@echo "üì¶ Installing dependencies..."
	@npm install
	@echo "‚úÖ Dependencies installed!"

dev: ## Start local development server
	@echo "üöÄ Starting local development server..."
	@npx http-server . -p 3000 -c-1

# =============================================================================
# üìã HELP
# =============================================================================

help: ## Show this help
	@echo "üé® Bar Restaurant UI Service"
	@echo ""
	@echo "Usage: make [command]"
	@echo ""
	@echo "Docker Commands:"
	@grep -E '^(start|stop|restart|logs|status|clean):.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  %-12s %s\n", $$1, $$2}'
	@echo ""
	@echo "Testing:"
	@grep -E '^test:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  %-12s %s\n", $$1, $$2}'
	@echo ""
	@echo "Local Development:"
	@grep -E '^(install|dev):.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  %-12s %s\n", $$1, $$2}'

